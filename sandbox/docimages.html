<!--
	Author:		Kovacs Viktor
	Homepage:	http://www.kovacsv.hu
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	 "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>
	<meta http-equiv="X-UA-Compatible" content="IE=9; IE=8; IE=7;" > 
	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<script type="text/javascript" src="../src/core/jsm.js"></script>
	<script type="text/javascript" src="../src/core/timer.js"></script>
	<script type="text/javascript" src="../src/geometry/determinant.js"></script>
	<script type="text/javascript" src="../src/geometry/matrix.js"></script>
	<script type="text/javascript" src="../src/geometry/coord.js"></script>
	<script type="text/javascript" src="../src/geometry/coordutils.js"></script>
	<script type="text/javascript" src="../src/geometry/coordsystem.js"></script>
	<script type="text/javascript" src="../src/geometry/coordsystemutils.js"></script>
	<script type="text/javascript" src="../src/geometry/sector.js"></script>
	<script type="text/javascript" src="../src/geometry/sectorutils.js"></script>
	<script type="text/javascript" src="../src/geometry/line.js"></script>
	<script type="text/javascript" src="../src/geometry/lineutils.js"></script>
	<script type="text/javascript" src="../src/geometry/transformation.js"></script>
	<script type="text/javascript" src="../src/geometry/transformationutils.js"></script>
	<script type="text/javascript" src="../src/geometry/polygon.js"></script>
	<script type="text/javascript" src="../src/geometry/polygonutils.js"></script>
	<script type="text/javascript" src="../src/geometry/plane.js"></script>
	<script type="text/javascript" src="../src/geometry/planeutils.js"></script>
	<script type="text/javascript" src="../src/geometry/projection.js"></script>
	<script type="text/javascript" src="../src/modeler/camera.js"></script>
	<script type="text/javascript" src="../src/modeler/body.js"></script>
	<script type="text/javascript" src="../src/modeler/bodyutils.js"></script>
	<script type="text/javascript" src="../src/modeler/adjacencylist.js"></script>
	<script type="text/javascript" src="../src/modeler/subdivision.js"></script>
	<script type="text/javascript" src="../src/modeler/cututils.js"></script>
	<script type="text/javascript" src="../src/modeler/textureutils.js"></script>
	<script type="text/javascript" src="../src/modeler/model.js"></script>
	<script type="text/javascript" src="../src/modeler/material.js"></script>
	<script type="text/javascript" src="../src/modeler/generator.js"></script>
	<script type="text/javascript" src="../src/modeler/solidgenerator.js"></script>
	<script type="text/javascript" src="../src/modeler/exporter.js"></script>
	<script type="text/javascript" src="../src/modeler/shapes.js"></script>
	<script type="text/javascript" src="../build/three.min.js"></script>
	<script type="text/javascript" src="../src/viewer/converter.js"></script>
	<script type="text/javascript" src="../src/viewer/mouse.js"></script>
	<script type="text/javascript" src="../src/viewer/touch.js"></script>
	<script type="text/javascript" src="../src/viewer/viewer.js"></script>
	<title>Example</title>

	<script type="text/javascript">
		var viewer = null;
		var current = 0;
	
		function InitViewer (body)
		{
			viewer.RemoveMeshes ();
			
			var meshes = JSM.ConvertBodyToThreeMeshes (body);
			viewer.AddMeshes (meshes);
			
			viewer.FitInWindow ();
			viewer.Draw ();		
		}

		function Prev ()
		{
			current = current - 1;
			LoadModel ();
		}
		
		function Next ()
		{
			current = current + 1
			LoadModel ();
		}
		
		function LoadModel ()
		{
			if (current == 0) {
				var body = JSM.GenerateRectangle (1.0, 1.0);
				InitViewer (body);
			} else if (current == 1) {
				var body = JSM.GenerateCuboid (1.0, 1.0, 1.0);
				InitViewer (body);
			} else if (current == 2) {
				var body = JSM.GenerateSegmentedRectangle (1, 1, 4);
				InitViewer (body);
			} else if (current == 3) {
				var body = JSM.GenerateSegmentedCuboid (1, 1, 1, 4);
				InitViewer (body);
			} else if (current == 4) {
				var body = JSM.GenerateCircle (1.0, 25);
				InitViewer (body);
			} else if (current == 5) {
				var body = JSM.GenerateSphere (1, 10, false);
				InitViewer (body);
			} else if (current == 6) {
				var body = JSM.GenerateTriangulatedSphere (1, 3, false);
				InitViewer (body);
			} else if (current == 7) {
				var body = JSM.GenerateCylinder (0.5, 1.0, 25, true, false);
				InitViewer (body);
			} else if (current == 8) {
				var body = JSM.GeneratePie (1.0, 0.2, 270 * JSM.DegRad, 25, true, false);
				InitViewer (body);
			} else if (current == 9) {
				var body = JSM.GenerateCone (0.2, 0.6, 1.0, 25, true, false);
				InitViewer (body);
			} else if (current == 10) {
				var basePolygon = [
					new JSM.Coord (-1.0, -1.0, 0.0),
					new JSM.Coord (1.0, -1.0, 0.0),
					new JSM.Coord (1.0, 1.0, 0.0),
					new JSM.Coord (0.0, 1.0, 0.0),
					new JSM.Coord (0.0, 0.0, 0.0),
					new JSM.Coord (-1.0, 0.0, 0.0)
				];
				var direction = new JSM.Vector (0.0, 0.0, 1.0);
				var body = JSM.GeneratePrism (basePolygon, direction, 1.0, true);
				InitViewer (body);
			} else if (current == 11) {
				var basePolygon = [
					new JSM.Coord (-1.0, -1.0, 0.0),
					new JSM.Coord (1.0, -1.0, 0.0),
					new JSM.Coord (1.0, 1.0, 0.0),
					new JSM.Coord (-1.0, 1.0, 0.0),
					null,
					new JSM.Coord (-0.5, 0.5, 0.0),
					new JSM.Coord (0.5, 0.5, 0.0),
					new JSM.Coord (0.5, -0.5, 0.0),
					new JSM.Coord (-0.5, -0.5, 0.0)
				];
				var direction = new JSM.Vector (0.0, 0.0, 1.0);
				var body = JSM.GeneratePrismWithHole (basePolygon, direction, 1.0, true);
				InitViewer (body);
			} else if (current == 12) {
				var basePolygon = [
					new JSM.Coord (-1.0, -1.0, 0.0),
					new JSM.Coord (1.0, -1.0, 0.0),
					new JSM.Coord (1.0, 1.0, 0.0),
					new JSM.Coord (0.0, 1.0, 0.0),
					new JSM.Coord (0.0, 0.0, 0.0),
					new JSM.Coord (-1.0, 0.0, 0.0)
				];
				var direction = new JSM.Vector (0.0, 0.0, 1.0);
				var body = JSM.GeneratePrismShell (basePolygon, direction, 1.0, 0.2, true);
				InitViewer (body);
			} else if (current == 13) {
				var body = JSM.GenerateCylinderShell (0.5, 1.0, 0.2, 20, true, false);
				InitViewer (body);
			} else if (current == 1) {
				var basePolyLine = [
					new JSM.Coord (-1.0, -1.0, 0.0),
					new JSM.Coord (1.0, -1.0, 0.0),
					new JSM.Coord (1.0, 1.0, 0.0),
					new JSM.Coord (0.0, 1.0, 0.0),
					new JSM.Coord (0.0, 0.0, 0.0),
					new JSM.Coord (-1.0, 0.0, 0.0)
				];
				var direction = new JSM.Vector (0.0, 0.0, 1.0);
				var body = JSM.GenerateLineShell (basePolyLine, direction, 1.0, 0.2, true, true);
				InitViewer (body);
			} else if (current == 14) {
				var body = JSM.GenerateTorus (1.0, 0.5, 20, 20, false);
				InitViewer (body);
			} else if (current == 15) {
				var basePolygon = [
					new JSM.Coord (-1.0, -1.0, 0.0),
					new JSM.Coord (1.0, -1.0, 0.0),
					new JSM.Coord (1.0, 1.0, 0.0),
					new JSM.Coord (0.0, 1.0, 0.0),
					new JSM.Coord (0.0, 0.0, 0.0),
					new JSM.Coord (-1.0, 0.0, 0.0)
				];
				var direction = new JSM.Vector (0.0, 0.0, 1.0);
				var body = JSM.GeneratePolyTorus (basePolygon, 2.0, 20, false);
				InitViewer (body);
			} else if (current == 16) {
				var aSector = new JSM.Sector (new JSM.Coord (-1.0, 0.0, 0.0), new JSM.Coord (1.0, 0.0, 0.0));
				var bSector = new JSM.Sector (new JSM.Coord (0.0, 1.0, -1.0), new JSM.Coord (0.0, 1.0, 1.0));
				var body = JSM.GenerateRuledFromSectors (aSector, bSector, 10, 10, false);
				InitViewer (body);
			} else if (current == 17) {
				var polyLine = [
					new JSM.Coord (0.0, -1.0, -1.0),
					new JSM.Coord (0.0, -0.5, 0.0),
					new JSM.Coord (0.0, -1.0, 1.0)
				];
				var axis = new JSM.Sector (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Coord (0.0, 0.0, 1.0));
				var body = JSM.GenerateRevolved (polyLine, axis, 360.0 * JSM.DegRad, 20, true, false);
				InitViewer (body);
			}
		}

		function ToImage ()
		{
			viewer.Draw ();
			var canvas = document.getElementById ('example');
			window.location = canvas.toDataURL ('image/png');
		}
		
		window.onload = function ()
		{
			var viewerSettings = {
				'cameraEyePosition' : [-2.0, -1.5, 1.0],
				'cameraCenterPosition' : [0.0, 0.0, 0.0],
				'cameraUpVector' : [0.0, 0.0, 1.0]
			};

			viewer = new JSM.Viewer ();
			viewer.Start ('example', viewerSettings);

			LoadModel ();			
		}
	</script>

</head>

<body>
	<canvas id="example" width="200" height="200" style="border : 1px solid #000000; background : #ffffff;"></canvas>
	<br>
	<a href="javascript:Prev ()">prev</a>
	<a href="javascript:Next ()">next</a>
	<a href="javascript:ToImage ()">image</a>
</body>

</html>
