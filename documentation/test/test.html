<!--
	Author:		Kovacs Viktor
	Homepage:	http://www.kovacsv.hu
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	 "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>

	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<script type="text/javascript" src="../../src/core/jsm.js"></script>
	<script type="text/javascript" src="../../src/geometry/determinant.js"></script>
	<script type="text/javascript" src="../../src/geometry/matrix.js"></script>
	<script type="text/javascript" src="../../src/geometry/coord.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordutilsext.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordsystem.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordsystemutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/sector.js"></script>
	<script type="text/javascript" src="../../src/geometry/sectorutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/line.js"></script>
	<script type="text/javascript" src="../../src/geometry/lineutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/transformation.js"></script>
	<script type="text/javascript" src="../../src/geometry/transformationutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygon.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygonutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/plane.js"></script>
	<script type="text/javascript" src="../../src/geometry/planeutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/projection.js"></script>
	<script type="text/javascript" src="../../src/modeler/camera.js"></script>
	<script type="text/javascript" src="../../src/modeler/body.js"></script>
	<script type="text/javascript" src="../../src/modeler/bodyutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/cututils.js"></script>
	<script type="text/javascript" src="../../src/modeler/textureutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/model.js"></script>
	<script type="text/javascript" src="../../src/modeler/generator.js"></script>
	<script type="text/javascript" src="../../src/modeler/solidgenerator.js"></script>
	<script type="text/javascript" src="../../src/test/test.js"></script>
	<title>Example</title>

	<script type="text/javascript">
		function WriteCoord (test, coord)
		{
			test.Write ('(' + coord.x + ', ' + coord.y + ', ' + coord.z + ')');
		}
	
		function CoreTest (test)
		{
			var a = 0.0000001;
			var b = 0.0000002;
			var c = 0.000000001;
			var d = 0.000000002;
			
			var e = -0.0000001;
			var f = -0.0000002;
			var g = -0.000000001;
			var h = -0.000000002;
			
			test.Assert (!JSM.IsEqual (a, b));
			test.Assert (!JSM.IsEqual (a, e));

			test.Assert (JSM.IsEqual (c, d));
			test.Assert (JSM.IsEqual (c, g));
			
			test.Assert (JSM.IsPositive (a));
			test.Assert (!JSM.IsPositive (c));
			test.Assert (!JSM.IsPositive (d));

			test.Assert (JSM.IsNegative (e));
			test.Assert (!JSM.IsNegative (g));
			test.Assert (!JSM.IsNegative (h));

			test.Assert (JSM.IsLower (a, b));
			test.Assert (!JSM.IsLower (c, d));
			test.Assert (JSM.IsLowerOrEqual (c, d));

			test.Assert (JSM.IsGreater (b, a));
			test.Assert (!JSM.IsGreater (d, c));
			test.Assert (JSM.IsGreaterOrEqual (d, c));

			test.Assert (JSM.IsEqual (90.0 * JSM.DegRad, Math.PI / 2.0));
			test.Assert (JSM.IsEqual (Math.PI / 2.0 * JSM.RadDeg, 90.0));
		}

		function VectorTest (test)
		{
			var coord2d1 = new JSM.Coord2D (1, 2);
			var coord2d2 = new JSM.Coord2D (3, 4);
			var coord2d3 = new JSM.Coord2D (1, 6);
		
			test.Assert (JSM.CoordIsEqual2D (coord2d1, new JSM.Coord2D (1, 2)));
			test.Assert (JSM.CoordIsEqual2D (JSM.MidCoord2D (coord2d1, coord2d2), new JSM.Coord2D (2, 3)));
			test.Assert (JSM.IsEqual (JSM.CoordDistance2D (coord2d1, coord2d2), 2.8284271247));
			test.Assert (JSM.CoordTurnType2D (coord2d1, coord2d2, coord2d3) == 'CounterClockwise');
		
			var coord1 = new JSM.Coord (1, 2, 3);
			var coord2 = new JSM.Coord (4, 5, 6);

			test.Assert (JSM.CoordIsEqual (coord1, new JSM.Coord (1, 2, 3)));
			test.Assert (JSM.CoordIsEqual (JSM.MidCoord (coord1, coord2), new JSM.Coord (2.5, 3.5, 4.5)));
			test.Assert (JSM.CoordIsEqual (JSM.VectorMultiply (coord1, 3), new JSM.Coord (3, 6, 9)));
			test.Assert (JSM.IsEqual (JSM.VectorDot (coord1, coord2), 32));
			test.Assert (JSM.CoordIsEqual (JSM.VectorCross (coord1, coord2), new JSM.Coord (-3, 6, -3)));
			test.Assert (JSM.IsEqual (JSM.VectorLength (coord1), 3.7416573867));
			test.Assert (JSM.CoordIsEqual (JSM.VectorNormalize (coord1), new JSM.Coord (0.2672612419, 0.5345224838, 0.8017837257)));
			test.Assert (JSM.IsEqual (JSM.VectorLength (JSM.VectorSetLength (coord1, 123)), 123));
			test.Assert (JSM.IsEqual (JSM.CoordDistance (coord1, coord2), 5.1961524227));
			test.Assert (JSM.CoordIsEqual (JSM.CoordAdd (coord1, coord2), new JSM.Coord (5, 7, 9)));
			test.Assert (JSM.CoordIsEqual (JSM.CoordSub (coord1, coord2), new JSM.Coord (-3, -3, -3)));
			test.Assert (JSM.CoordIsEqual (JSM.CoordOffset (coord2, coord1, 5.0), new JSM.Coord (5.3363062095, 7.672612419, 10.0089186285)));
			
			var coord = new JSM.Coord (1.0, 1.0, 1.0);
			var direction = new JSM.Vector (1.0, 0.0, 0.0);
			test.Assert (JSM.CoordIsEqual (JSM.CoordOffset (coord, direction, 1.0), new JSM.Coord (2.0, 1.0, 1.0)));
			
			var coord = new JSM.Coord (1.0, 1.0, 1.0);
			var axis = new JSM.Vector (0.0, 0.0, 1.0);
			var origo = new JSM.Vector (0.0, 0.0, 0.0);
			var angle = 90.0 * JSM.DegRad;
			test.Assert (JSM.CoordIsEqual (JSM.CoordRotate (coord, axis, angle, origo), new JSM.Coord (-1.0, 1.0, 1.0)));

			var vector1 = new JSM.Vector (1.0, 0.0, 0.0);
			var vector2 = new JSM.Vector (0.0, 1.0, 0.0);
			test.Assert (JSM.IsEqual (JSM.GetVectorsAngle (vector1, vector2), 90.0 * JSM.DegRad));

			var vector = new JSM.Vector (1.0, 0.0, 0.0);
			test.Assert (JSM.IsEqual (JSM.VectorLength (vector), 1.0));
			
			var vector = new JSM.Vector (1.0, 2.0, 3.0);
			var multiplied = JSM.VectorMultiply (vector, 2.0);
			test.Assert (JSM.CoordIsEqual (multiplied, new JSM.Coord (2.0, 4.0, 6.0)));
			
			var vector = new JSM.Vector (10.0, 0.0, 0.0);
			var normal = JSM.VectorNormalize (vector);
			test.Assert (JSM.CoordIsEqual (normal, new JSM.Coord (1.0, 0.0, 0.0)));
			
			var another = JSM.VectorSetLength (vector, 5.0);
			test.Assert (JSM.CoordIsEqual (another, new JSM.Coord (5.0, 0.0, 0.0)));

			var cartesian = JSM.SphericalToCartesian (1.0, 90.0 * JSM.DegRad, 0.0 * JSM.DegRad);
			test.Assert (JSM.CoordIsEqual (cartesian, new JSM.Coord (0.0, 0.0, 1.0)));

			var cartesian = JSM.CylindricalToCartesian (1.0, 90.0 * JSM.DegRad, 1.0);
			test.Assert (JSM.CoordIsEqual (cartesian, new JSM.Coord (0.0, 1.0, 1.0)));

			var coord = new JSM.Coord (1.0, 2.0, 3.0);
			var normal = new JSM.Coord (0.0, 1.0, 0.0);
			var origo = new JSM.Coord (0.0, 0.0, 0.0);
			var coord2D = JSM.GetCoord2DFromCoord (coord, origo, normal);
			test.Assert (JSM.CoordIsEqual2D (coord2D, new JSM.Coord (1.0, -3.0)));

			var coords = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			var normal = JSM.CalculateNormal (coords);
			test.Assert (JSM.CoordIsEqual (normal, new JSM.Coord (0.0, 0.0, 1.0)));

			var coords2 = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.5, 0.5, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			var normal2 = JSM.CalculateNormal (coords2);
			test.Assert (JSM.CoordIsEqual (normal2, new JSM.Coord (0.0, 0.0, 1.0)));

			var coords3 = [
				new JSM.Coord (0.0, 1.0, 0.0),
				new JSM.Coord (0.5, 0.5, 0.0),
				new JSM.Coord (0.5, 0.5, 0.0),
				new JSM.Coord (0.5, 0.5, 0.0),
				new JSM.Coord (0.0, 0.0, 0.0)
			];
			var normal3 = JSM.CalculateNormal (coords3);
			test.Assert (JSM.CoordIsEqual (normal3, new JSM.Coord (0.0, 0.0, -1.0)));
			var vector1 = new JSM.Vector (1.0, 0.0, 0.0);
			var vector2 = new JSM.Vector (0.0, 1.0, 0.0);
			test.Assert (JSM.IsEqual (JSM.GetVectorsAngle (vector1, vector2), Math.PI / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetVectorsAngle (vector2, vector1), Math.PI / 2.0));

			var coord1 = new JSM.Vector (0.0, 0.0, 0.0);
			var coord2 = new JSM.Vector (1.0, 0.0, 0.0);
			var coord3 = new JSM.Vector (0.0, 1.0, 0.0);
			var normal1 = new JSM.Vector (0.0, 0.0, 1.0);
			var normal2 = new JSM.Vector (0.0, 0.0, -1.0);
			var normal3 = new JSM.Vector (0.0, -1.0, -1.0);

			test.Assert (JSM.CoordTurnType (coord1, coord2, coord3, normal1) == 'CounterClockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord2, normal1) == 'Clockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord3, normal1) == 'Collinear');

			test.Assert (JSM.CoordTurnType (coord1, coord2, coord3, normal2) == 'Clockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord2, normal2) == 'CounterClockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord3, normal2) == 'Collinear');

			test.Assert (JSM.CoordTurnType (coord1, coord2, coord3, normal3) == 'Clockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord2, normal3) == 'CounterClockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord3, normal3) == 'Collinear');

			var coord1 = new JSM.Vector (0.0, 0.0, 0.0);
			var coord2 = new JSM.Vector (1.0, 0.0, 0.0);
			var coord3 = new JSM.Vector (0.0, 0.0, 1.0);
			var normal1 = new JSM.Vector (0.0, 1.0, 0.0);
			var normal2 = new JSM.Vector (0.0, -1.0, 0.0);

			test.Assert (JSM.CoordTurnType (coord1, coord2, coord3, normal2) == 'CounterClockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord2, normal2) == 'Clockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord3, normal2) == 'Collinear');

			test.Assert (JSM.CoordTurnType (coord1, coord2, coord3, normal1) == 'Clockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord2, normal1) == 'CounterClockwise');
			test.Assert (JSM.CoordTurnType (coord1, coord3, coord3, normal1) == 'Collinear');
			
			var coord1 = new JSM.Vector (0.0, 0.0, 0.0);
			var coord2 = new JSM.Vector (1.0, 0.0, 0.0);
			var coord3 = new JSM.Vector (-1.0, 0.0, 0.0);
			test.Assert (JSM.IsEqual (JSM.CoordSignedDistance (coord1, coord2, JSM.CoordSub (coord2, coord1)), 1.0));
			test.Assert (JSM.IsEqual (JSM.CoordSignedDistance (coord1, coord3, JSM.CoordSub (coord1, coord3)), -1.0));
		}

		function MatrixTest (test)
		{
			var vector1 = [1, 2, 3, 4];
			var matrix1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16];
			var matrix2 = [17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32];
			
			var vector2 = JSM.VectorMatrixMultiply4x4 (vector1, matrix1);
			var matrix3 = JSM.MatrixMultiply4x4 (matrix1, matrix2);
			
			test.Assert (vector2[0] == 90);
			test.Assert (vector2[1] == 100);
			test.Assert (vector2[2] == 110);
			test.Assert (vector2[3] == 120);

			test.Assert (matrix3[0] == 250);
			test.Assert (matrix3[1] == 260);
			test.Assert (matrix3[2] == 270);
			test.Assert (matrix3[3] == 280);
			test.Assert (matrix3[4] == 618);
			test.Assert (matrix3[5] == 644);
			test.Assert (matrix3[6] == 670);
			test.Assert (matrix3[7] == 696);
			test.Assert (matrix3[8] == 986);
			test.Assert (matrix3[9] == 1028);
			test.Assert (matrix3[10] == 1070);
			test.Assert (matrix3[11] == 1112);
			test.Assert (matrix3[12] == 1354);
			test.Assert (matrix3[13] == 1412);
			test.Assert (matrix3[14] == 1470);
			test.Assert (matrix3[15] == 1528);
		}

		function ArcLengthTest (test)
		{
			var a1 = new JSM.Vector (0.0, 1.0, 0.0);
			var a2 = new JSM.Vector (0.0, -1.0, 0.0);
			var a3 = new JSM.Vector (-1.0, 0.0, 0.0);
			var a4 = new JSM.Vector (1.0, 1.0, 0.0);
			var a5 = new JSM.Vector (1.0, -1.0, 0.0);
			
			var b1 = new JSM.Vector (1.0, 0.0, 0.0);
			
			var radius1 = 1.0;
			var radius2 = 2.0;
			
			var circ1 = 2.0 * radius1 * Math.PI;
			var circ2 = 2.0 * radius2 * Math.PI;
			
			var normal1 = new JSM.Vector (0.0, 0.0, 1.0);
			var normal2 = new JSM.Vector (0.0, 0.0, -1.0);
			
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a1, a1, radius1), 0.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a1, b1, radius1), circ1 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a2, b1, radius1), circ1 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a3, b1, radius1), circ1 / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a4, b1, radius1), circ1 / 8.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a5, b1, radius1), circ1 / 8.0));

			test.Assert (JSM.IsEqual (JSM.GetArcLength (a1, a1, radius2), 0.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a1, b1, radius2), circ2 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a2, b1, radius2), circ2 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a3, b1, radius2), circ2 / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a4, b1, radius2), circ2 / 8.0));
			test.Assert (JSM.IsEqual (JSM.GetArcLength (a5, b1, radius2), circ2 / 8.0));
			
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a1, b1, radius1, normal1), circ1 * 3.0 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a2, b1, radius1, normal1), circ1 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a3, b1, radius1, normal1), circ1 / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a4, b1, radius1, normal1), circ1 * 7.0 / 8.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a5, b1, radius1, normal1), circ1 / 8.0));

			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a1, b1, radius2, normal1), circ2 * 3.0 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a2, b1, radius2, normal1), circ2 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a3, b1, radius2, normal1), circ2 / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a4, b1, radius2, normal1), circ2 * 7.0 / 8.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a5, b1, radius2, normal1), circ2 / 8.0));

			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a1, b1, radius1, normal2), circ1 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a2, b1, radius1, normal2), circ1 * 3.0 / 4.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a3, b1, radius1, normal2), circ1 / 2.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a4, b1, radius1, normal2), circ1 / 8.0));
			test.Assert (JSM.IsEqual (JSM.GetFullArcLength (a5, b1, radius1, normal2), circ1 * 7.0 / 8.0));
		}
		
		function TransformationTest (test)
		{
			var transformation = new JSM.IdentityTransformation ();
			
			var coord = new JSM.Coord (1.0, 1.0, 1.0);
			var direction = new JSM.Vector (1.0, 0.0, 0.0);
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord), new JSM.Coord (1.0, 1.0, 1.0)));

			transformation = JSM.TranslationTransformation (direction, 1.0);
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord), new JSM.Coord (2.0, 1.0, 1.0)));

			var axis = new JSM.Vector (0.0, 0.0, 1.0);
			var angle = 90.0 * JSM.DegRad;
			transformation = JSM.RotationTransformation (axis, angle);
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord), new JSM.Coord (-1.0, 1.0, 1.0)));
			
			
			var trX = new JSM.RotationXTransformation (angle);
			var trY = new JSM.RotationYTransformation (angle);
			var trZ = new JSM.RotationZTransformation (angle);
			
			var axisX = new JSM.Vector (1.0, 0.0, 0.0);
			var axisY = new JSM.Vector (0.0, 1.0, 0.0);
			var axisZ = new JSM.Vector (0.0, 0.0, 1.0);
			
			var trRotX = new JSM.RotationTransformation (axisX, angle);
			var trRotY = new JSM.RotationTransformation (axisY, angle);
			var trRotZ = new JSM.RotationTransformation (axisZ, angle);

			test.Assert (JSM.CoordIsEqual (trX.Apply (coord), trRotX.Apply (coord)));
			test.Assert (JSM.CoordIsEqual (trY.Apply (coord), trRotY.Apply (coord)));
			test.Assert (JSM.CoordIsEqual (trZ.Apply (coord), trRotZ.Apply (coord)));

			var origo = new JSM.Coord (0.0, 0.0, 0.0);
			trRotX = new JSM.RotationTransformation (axisX, angle, origo);
			trRotY = new JSM.RotationTransformation (axisY, angle, origo);
			trRotZ = new JSM.RotationTransformation (axisZ, angle, origo);

			test.Assert (JSM.CoordIsEqual (trX.Apply (coord), trRotX.Apply (coord)));
			test.Assert (JSM.CoordIsEqual (trY.Apply (coord), trRotY.Apply (coord)));
			test.Assert (JSM.CoordIsEqual (trZ.Apply (coord), trRotZ.Apply (coord)));

			var coord = new JSM.Coord (1.0, 2.0, 3.0);
			var axis = new JSM.Vector (4.0, 5.0, 6.0);
			var angle = 7.0 * JSM.DegRad;
			var origo = new JSM.Coord (8.0, 9.0, 10.0);
			transformation = new JSM.RotationTransformation (axis, angle, origo);
			test.Assert (JSM.CoordIsEqual (JSM.CoordRotate (coord, axis, angle, origo), transformation.Apply (coord)));
			
			var coord = new JSM.Coord (1.0, 2.0, 3.0);
			var direction = new JSM.Coord (4.0, 5.0, 6.0);
			var axis = new JSM.Vector (4.0, 5.0, 6.0);
			var angle = 7.0 * JSM.DegRad;
			var origo = new JSM.Coord (8.0, 9.0, 10.0);
			var result1 = coord;
			result1 = JSM.CoordOffset (result1, direction, 11.0);
			result1 = JSM.CoordRotate (result1, axis, angle, origo);
			
			var offsetTransformation = new JSM.TranslationTransformation (direction, 11.0);
			var rotateTransformation = new JSM.RotationTransformation (axis, angle, origo);
			
			var transformation = new JSM.Transformation ();
			transformation.Append (offsetTransformation);
			transformation.Append (rotateTransformation);
			
			var result2 = transformation.Apply (coord);
			test.Assert (JSM.CoordIsEqual (result1, result2));
		}
		
		function SystemConversionTest (test)
		{
			var system1 = new JSM.CoordSystem (
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Vector (0.0, 1.0, 0.0),
				new JSM.Vector (-1.0, 0.0, 0.0),
				new JSM.Vector (0.0, 0.0, 1.0)
			);

			var system2 = new JSM.CoordSystem (
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Vector (1.0, 0.0, 0.0),
				new JSM.Vector (0.0, 1.0, 0.0),
				new JSM.Vector (0.0, 0.0, 1.0)
			);

			var transformation = new JSM.SystemConversionTransformation (system1.e1, system1.e2, system1.e3, system2.e1, system2.e2, system2.e3);
			
			var coord0 = new JSM.Coord (0.0, 0.0, 0.0);
			var coord1 = new JSM.Coord (1.0, 0.0, 0.0);
			var coord2 = new JSM.Coord (0.0, 1.0, 0.0);
			var coord3 = new JSM.Coord (0.0, 0.0, 1.0);
			var coord4 = new JSM.Coord (1.0, 1.0, 0.0);
			var coord5 = new JSM.Coord (-1.0, 1.0, 0.0);
			
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord0), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord1), new JSM.Coord (0.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord2), new JSM.Coord (-1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord3), new JSM.Coord (0.0, 0.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord4), new JSM.Coord (-1.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (transformation.Apply (coord5), new JSM.Coord (-1.0, -1.0, 0.0)));

			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord0, system1, system2), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord1, system1, system2), new JSM.Coord (0.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord2, system1, system2), new JSM.Coord (-1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord3, system1, system2), new JSM.Coord (0.0, 0.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord4, system1, system2), new JSM.Coord (-1.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord5, system1, system2), new JSM.Coord (-1.0, -1.0, 0.0)));
			
			system2.origo.x = 1.0;
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord0, system1, system2), new JSM.Coord (1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord1, system1, system2), new JSM.Coord (1.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord2, system1, system2), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord3, system1, system2), new JSM.Coord (1.0, 0.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord4, system1, system2), new JSM.Coord (0.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord5, system1, system2), new JSM.Coord (0.0, -1.0, 0.0)));

			system1.origo.x = 1.0;
			system2.origo.x = 2.0;
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord0, system1, system2), new JSM.Coord (2.0, -1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord1, system1, system2), new JSM.Coord (2.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord2, system1, system2), new JSM.Coord (1.0, -1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord3, system1, system2), new JSM.Coord (2.0, -1.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord4, system1, system2), new JSM.Coord (1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (coord5, system1, system2), new JSM.Coord (1.0, -2.0, 0.0)));

			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (2.0, -1.0, 0.0), system2, system1), coord0));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (2.0, 0.0, 0.0), system2, system1), coord1));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (1.0, -1.0, 0.0), system2, system1), coord2));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (2.0, -1.0, 1.0), system2, system1), coord3));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (1.0, 0.0, 0.0), system2, system1), coord4));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (new JSM.Coord (1.0, -2.0, 0.0), system2, system1), coord5));

			var o1 = new JSM.Coord (1.0, 0.0, 0.0);
			var o2 = new JSM.Coord (2.0, 0.0, 0.0);
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (o1, system1, system2), new JSM.Coord (2.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ChangeCoordSystem (o2, system2, system1), new JSM.Coord (1.0, 0.0, 0.0)));
		}

		function SectorTest (test)
		{
			var beg = new JSM.Coord2D (1.0, 2.0);
			var end = new JSM.Coord2D (3.0, 4.0);
			
			var sector = new JSM.Sector2D (beg, end);
			test.Assert (JSM.CoordIsEqual2D (sector.beg, new JSM.Coord2D (1.0, 2.0)));
			test.Assert (JSM.CoordIsEqual2D (sector.end, new JSM.Coord2D (3.0, 4.0)));
			
			sector.Set (end, beg);
			test.Assert (JSM.CoordIsEqual2D (sector.beg, new JSM.Coord2D (3.0, 4.0)));
			test.Assert (JSM.CoordIsEqual2D (sector.end, new JSM.Coord2D (1.0, 2.0)));

			var beg = new JSM.Coord (1.0, 2.0, 3.0);
			var end = new JSM.Coord (4.0, 5.0, 6.0);
			
			var sector = new JSM.Sector (beg, end);
			test.Assert (JSM.CoordIsEqual (sector.beg, new JSM.Coord (1.0, 2.0, 3.0)));
			test.Assert (JSM.CoordIsEqual (sector.end, new JSM.Coord (4.0, 5.0, 6.0)));
			
			sector.Set (end, beg);
			test.Assert (JSM.CoordIsEqual (sector.beg, new JSM.Coord (4.0, 5.0, 6.0)));
			test.Assert (JSM.CoordIsEqual (sector.end, new JSM.Coord (1.0, 2.0, 3.0)));
		}
	
		function LineTest (test)
		{
			var start2D = new JSM.Coord2D (1.0, 1.0);
			var direction2D = new JSM.Coord2D (1.0, 0.0);
			var line2D = new JSM.Line2D (start2D, direction2D);
			test.Assert (JSM.CoordLinePosition2D (new JSM.Coord2D (0.0, 0.0), line2D) == 'CoordAtLineRight');
			test.Assert (JSM.CoordLinePosition2D (new JSM.Coord2D (0.0, 2.0), line2D) == 'CoordAtLineLeft');
			test.Assert (JSM.CoordLinePosition2D (new JSM.Coord2D (0.0, 1.0), line2D) == 'CoordOnLine');

			var start = new JSM.Coord (1.0, 1.0, 1.0);
			var direction = new JSM.Coord (1.0, 0.0, 0.0);
			var line = new JSM.Line (start, direction);

			var projected = new JSM.Coord ();
			test.Assert (JSM.CoordLinePosition (new JSM.Coord (0.0, 0.0, 0.0), line, projected) == 'CoordOutsideOfLine');
			test.Assert (JSM.CoordIsEqual (projected, new JSM.Coord (0.0, 1.0, 1.0)));
			test.Assert (JSM.CoordLinePosition (new JSM.Coord (1.0, 1.0, 1.0), line, projected) == 'CoordOnLine');
			test.Assert (JSM.CoordIsEqual (projected, new JSM.Coord (1.0, 1.0, 1.0)));
			test.Assert (JSM.CoordLinePosition (new JSM.Coord (2.0, 1.0, 1.0), line, projected) == 'CoordOnLine');
			test.Assert (JSM.CoordIsEqual (projected, new JSM.Coord (2.0, 1.0, 1.0)));

			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToLine (new JSM.Coord (0.0, 0.0, 0.0), line), new JSM.Coord (0.0, 1.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToLine (new JSM.Coord (1.0, 1.0, 1.0), line), new JSM.Coord (1.0, 1.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToLine (new JSM.Coord (2.0, 1.0, 1.0), line), new JSM.Coord (2.0, 1.0, 1.0)));
		}

		function GetSector2D (a, b, c, d)
		{
			return new JSM.Sector2D (new JSM.Coord2D (a, b), new JSM.Coord2D (c, d));
		}

		function CoordSectorPosition2DTest (test)
		{
			var coord = new JSM.Coord2D (1.0, 0.0);
			var sector = new JSM.Sector2D (new JSM.Coord2D (0.0, 1.0), new JSM.Coord2D (1.0, 1.0));
			test.Assert (JSM.CoordSectorPosition2D (coord, sector) == 'CoordOutsideOfSector');

			var sector1 = new JSM.Sector2D (new JSM.Coord2D (1.0, 2.0), new JSM.Coord2D (1.0, 2.0));
			var sector2 = new JSM.Sector2D (new JSM.Coord2D (1.0, 2.0), new JSM.Coord2D (4.0, 3.0));
			var sector3 = new JSM.Sector2D (new JSM.Coord2D (1.0, 1.0), new JSM.Coord2D (3.0, 1.0));
			var sector4 = new JSM.Sector2D (new JSM.Coord2D (0.0, 1.0), new JSM.Coord2D (1.0, 1.0));
		
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (0.0, 0.0), sector1) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.0, 2.0), sector1) == 'CoordOnSectorEndCoord');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.0, 2.001), sector1) == 'CoordOutsideOfSector');
		
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (0.0, 0.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (7.0, 5.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (-2.0, 2.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (2.0, 2.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (3.0, 2.5), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (2.0, 3.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (3.0, 3.0), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.0, 2.0), sector2) == 'CoordOnSectorEndCoord');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (4.0, 3.0), sector2) == 'CoordOnSectorEndCoord');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (2.5, 2.5), sector2) == 'CoordInsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.75, 2.25), sector2) == 'CoordInsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (2.5, 2.501), sector2) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.75, 2.26), sector2) == 'CoordOutsideOfSector');
		
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (4.0, 1.0), sector3) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (3.001, 1.0), sector3) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (0.0, 1.0), sector3) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (0.999, 1.0), sector3) == 'CoordOutsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.0, 1.0), sector3) == 'CoordOnSectorEndCoord');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (3.0, 1.0), sector3) == 'CoordOnSectorEndCoord');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.1, 1.0), sector3) == 'CoordInsideOfSector');
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (1.123456789, 1.0), sector3) == 'CoordInsideOfSector');
		
			test.Assert (JSM.CoordSectorPosition2D (new JSM.Coord2D (0.0, 0.0), sector4) == 'CoordOutsideOfSector');
		}
		
		function SectorSectorPosition2DTest (test)
		{
			var sector1 = new JSM.Sector2D (new JSM.Coord2D (0.0, 1.0), new JSM.Coord2D (1.0, 1.0));
			var sector2 = new JSM.Sector2D (new JSM.Coord2D (0.0, 2.0), new JSM.Coord2D (1.0, 2.0));
			test.Assert (JSM.SectorSectorPosition2D (sector1, sector2) == 'SectorsDontIntersects');
		
			var sector1 = new JSM.Sector2D (new JSM.Coord2D (1.0, 2.0), new JSM.Coord2D (1.0, 2.0));
			var sector2 = new JSM.Sector2D (new JSM.Coord2D (1.0, 2.0), new JSM.Coord2D (4.0, 3.0));
			var sector3 = new JSM.Sector2D (new JSM.Coord2D (1.0, 1.0), new JSM.Coord2D (3.0, 1.0));
			var sector4 = new JSM.Sector2D (new JSM.Coord2D (0.0, 1.0), new JSM.Coord2D (1.0, 1.0));

			var intersection = new JSM.Coord2D ();
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 0.0, 0.0, 1.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 0.0, 1.0, 0.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 0.0, 1.0, 1.0), intersection) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.CoordIsEqual2D (intersection, new JSM.Coord2D (1.0, 1.0)));
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 0.0, 3.0, 1.0), intersection) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.CoordIsEqual2D (intersection, new JSM.Coord2D (3.0, 1.0)));
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (1.0, 1.0, 3.0, 1.0)) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (3.0, 1.0, 1.0, 1.0)) == 'SectorsIntersectsCoincident');
		
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (1.0, 0.0, 1.0, 1.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (1.0, 0.0, 1.0, 2.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (3.0, 0.0, 3.0, 1.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (3.0, 0.0, 3.0, 2.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (2.0, 0.0, 4.0, 2.0)) == 'SectorsIntersectsEndPoint');
		
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (-1.0, 1.0, 0.0, 1.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (4.0, 1.0, 5.0, 1.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 0.0, 2.0, 0.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (1.0, 0.0, 3.0, 0.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (1.0, 2.0, 3.0, 2.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 1.0, 1.0, 1.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (3.0, 1.0, 4.0, 1.0)) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (0.0, 1.0, 2.0, 1.0)) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (2.0, 1.0, 2.5, 1.0)) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (2.0, 1.0, 3.0, 1.0)) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (2.0, 1.0, 4.0, 1.0)) == 'SectorsIntersectsCoincident');
		
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (4.0, 1.0, 5.0, 1.0)) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (sector3, GetSector2D (-1.0, 1.0, -3.0, 1.0)) == 'SectorsDontIntersects');
		
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (-1.0, 1.0, 0.0, 1.0), sector3) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (4.0, 1.0, 5.0, 1.0), sector3) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (0.0, 0.0, 2.0, 0.0), sector3) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (1.0, 0.0, 3.0, 0.0), sector3) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (1.0, 2.0, 3.0, 2.0), sector3) == 'SectorsDontIntersects');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (0.0, 1.0, 1.0, 1.0), sector3) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (3.0, 1.0, 4.0, 1.0), sector3) == 'SectorsIntersectsEndPoint');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (0.0, 1.0, 2.0, 1.0), sector3) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (2.0, 1.0, 2.5, 1.0), sector3) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (2.0, 1.0, 3.0, 1.0), sector3) == 'SectorsIntersectsCoincident');
			test.Assert (JSM.SectorSectorPosition2D (GetSector2D (2.0, 1.0, 4.0, 1.0), sector3) == 'SectorsIntersectsCoincident');
		}
	
		function CoordPolygonPosition2DTest (test)
		{
			var polygon = new JSM.Polygon2D ();
			polygon.AddVertex (0.0, 2.0);
			polygon.AddVertex (0.0, 1.0);
			polygon.AddVertex (1.0, 1.0);
			polygon.AddVertex (1.0, 0.0);
			polygon.AddVertex (2.0, 0.0);
			polygon.AddVertex (2.0, 1.0);
			polygon.AddVertex (3.0, 1.0);
			polygon.AddVertex (3.0, 2.0);
			polygon.AddVertex (1.5, 3.0);
		
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.0, 0.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.5, 5.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.0, 3.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.0, 4.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (3.0, 0.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (2.5, 0.5), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (4.0, 2.0), polygon) == 'CoordOutsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (-1.0, 1.0), polygon) == 'CoordOutsideOfPolygon');
		
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.0, 1.5), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.5, 1.0), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.0, 0.5), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.5, 0.0), polygon) == 'CoordOnPolygonEdge');
		
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.0, 2.0), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.0, 1.0), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.0, 1.0), polygon) == 'CoordOnPolygonEdge');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (3.0, 2.0), polygon) == 'CoordOnPolygonEdge');
		
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.5, 1.5), polygon) == 'CoordInsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.5, 0.5), polygon) == 'CoordInsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.5, 1.5), polygon) == 'CoordInsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (2.5, 1.5), polygon) == 'CoordInsideOfPolygon');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (1.5, 1.0), polygon) == 'CoordInsideOfPolygon');
		}
	
		function PolygonTest (test)
		{
			var polygon = new JSM.Polygon2D ();
			polygon.AddVertex (0.0, 0.0);
			polygon.AddVertex (1.0, 0.0);
			polygon.AddVertex (0.0, 1.0);
			test.Assert (JSM.IsEqual (JSM.PolygonSignedArea2D (polygon), 0.5));
			test.Assert (JSM.PolygonOrientation2D (polygon) == 'CounterClockwise');
			test.Assert (JSM.PolygonComplexity2D (polygon) == 'Convex');
			test.Assert (JSM.CoordPolygonPosition2D (new JSM.Coord2D (0.2, 0.2), polygon) == 'CoordInsideOfPolygon');

			var polygon = new JSM.Polygon2D ();
			polygon.AddVertex (0.0, 0.0);
			polygon.AddVertex (1.0, 0.0);
			polygon.AddVertex (1.0, 1.0);
			polygon.AddVertex (0.0, 1.0);
			test.Assert (JSM.IsPolygonVertexVisible2D (polygon, 0, 2) == true);
			
			var triangles = JSM.PolygonTriangulate2D (polygon);
			test.Assert (triangles.length == 2);
			test.Assert (triangles[0].toString () == '0,1,2');
			test.Assert (triangles[1].toString () == '0,2,3');
			test.Assert (JSM.CheckTriangulation2D (polygon, triangles) == true);

			var polygon = new JSM.Polygon ();
			polygon.AddVertex (0.0, 0.0, 0.0);
			polygon.AddVertex (1.0, 0.0, 0.0);
			polygon.AddVertex (1.0, 1.0, 0.0);
			polygon.AddVertex (0.0, 1.0, 0.0);
			var triangles = JSM.PolygonTriangulate (polygon);
			test.Assert (triangles.length == 2);
			test.Assert (triangles[0].toString () == '0,1,2');
			test.Assert (triangles[1].toString () == '0,2,3');
		}
	
		function PolygonVertexVisibility2DTest (test)
		{
			function GetVisibleVertices (polygon, from)
			{
				var result = [];
				for (var i = 0; i < polygon.Count (); i++) {
					if (JSM.IsPolygonVertexVisible2D (polygon, from, i)) {
						result.push (i);
					}
				}
				return result;
			}

			var polygon = new JSM.Polygon2D ();
			polygon.AddVertex (0.0, 0.0);
			polygon.AddVertex (3.0, 0.0);
			polygon.AddVertex (3.0, 2.0);
			polygon.AddVertex (2.0, 2.0);
			polygon.AddVertex (2.0, 1.0);
			polygon.AddVertex (1.0, 1.0);
			polygon.AddVertex (1.0, 2.0);
			polygon.AddVertex (0.0, 2.0);
			
			test.Assert (GetVisibleVertices (polygon, 0).toString () == [4, 5, 6].toString ());
			test.Assert (GetVisibleVertices (polygon, 1).toString () == [3, 4, 5].toString ());
			test.Assert (GetVisibleVertices (polygon, 2).toString () == [4].toString ());
			test.Assert (GetVisibleVertices (polygon, 3).toString () == [1].toString ());
			test.Assert (GetVisibleVertices (polygon, 4).toString () == [0, 1, 2].toString ());
			test.Assert (GetVisibleVertices (polygon, 5).toString () == [0, 1, 7].toString ());
			test.Assert (GetVisibleVertices (polygon, 6).toString () == [0].toString ());
			test.Assert (GetVisibleVertices (polygon, 7).toString () == [5].toString ());

			var polygon5 = new JSM.Polygon2D ();
			polygon5.AddVertex (118, 121);
			polygon5.AddVertex (244, 89);
			polygon5.AddVertex (188, 222);
			polygon5.AddVertex (104, 219);
			polygon5.AddVertex (135, 139);
			polygon5.AddVertex (167, 140);
			polygon5.AddVertex (152, 189);
			polygon5.AddVertex (170, 189);
			polygon5.AddVertex (192, 118);
			
			test.Assert (JSM.IsPolygonVertexVisible2D (polygon5, 1, 4) == false);
		}
		
		function PolygonTriangulation2DTest (test)
		{
			var polygon = new JSM.Polygon2D ();
			polygon.AddVertex (0.0, 0.0);
			polygon.AddVertex (3.0, 0.0);
			polygon.AddVertex (3.0, 2.0);
			polygon.AddVertex (1.5, 3.0);
			polygon.AddVertex (0.0, 2.0);
			
			var triangles = JSM.PolygonTriangulate2D (polygon);
			test.Assert (JSM.CheckTriangulation2D (polygon, triangles));
			test.Assert (triangles.length == 3);
			test.Assert (triangles[0].toString () == [0, 1, 2].toString ());
			test.Assert (triangles[1].toString () == [0, 2, 3].toString ());
			test.Assert (triangles[2].toString () == [0, 3, 4].toString ());

			var polygon2 = new JSM.Polygon2D ();
			polygon2.AddVertex (0.0, 0.0);
			polygon2.AddVertex (3.0, 0.0);
			polygon2.AddVertex (3.0, 2.0);
			polygon2.AddVertex (2.0, 2.0);
			polygon2.AddVertex (2.0, 1.0);
			polygon2.AddVertex (1.0, 1.0);
			polygon2.AddVertex (1.0, 2.0);
			polygon2.AddVertex (0.0, 2.0);
			
			var triangles = JSM.PolygonTriangulate2D (polygon2);
			test.Assert (JSM.CheckTriangulation2D (polygon2, triangles));
			test.Assert (triangles.length == 6);
			test.Assert (triangles[0].toString () == [1, 4, 0].toString ());
			test.Assert (triangles[1].toString () == [5, 0, 4].toString ());
			test.Assert (triangles[2].toString () == [2, 4, 1].toString ());
			test.Assert (triangles[3].toString () == [4, 2, 3].toString ());
			test.Assert (triangles[4].toString () == [6, 0, 5].toString ());
			test.Assert (triangles[5].toString () == [0, 6, 7].toString ());
			
			var polygon2cw = new JSM.Polygon2D ();
			polygon2cw.AddVertex (0.0, 0.0);
			polygon2cw.AddVertex (0.0, 2.0);
			polygon2cw.AddVertex (1.0, 2.0);
			polygon2cw.AddVertex (1.0, 1.0);
			polygon2cw.AddVertex (2.0, 1.0);
			polygon2cw.AddVertex (2.0, 2.0);
			polygon2cw.AddVertex (3.0, 2.0);
			polygon2cw.AddVertex (3.0, 0.0);
			
			var triangles = JSM.PolygonTriangulate2D (polygon2cw);
			test.Assert (JSM.CheckTriangulation2D (polygon2cw, triangles));
			test.Assert (triangles.length == 6);
			test.Assert (triangles[0].toString () == [6, 7, 5].toString ());
			test.Assert (triangles[1].toString () == [5, 7, 4].toString ());
			test.Assert (triangles[2].toString () == [4, 7, 3].toString ());
			test.Assert (triangles[3].toString () == [2, 3, 1].toString ());
			test.Assert (triangles[4].toString () == [1, 3, 0].toString ());
			test.Assert (triangles[5].toString () == [7, 0, 3].toString ());

			var polygon3 = new JSM.Polygon2D ();
			polygon3.AddVertex (0.0, 0.0);
			polygon3.AddVertex (5.0, 0.0);
			polygon3.AddVertex (5.0, 1.0);
			polygon3.AddVertex (1.0, 1.0);
			polygon3.AddVertex (1.0, 5.0);
			polygon3.AddVertex (4.0, 5.0);
			polygon3.AddVertex (4.0, 3.0);
			polygon3.AddVertex (3.0, 3.0);
			polygon3.AddVertex (3.0, 4.0);
			polygon3.AddVertex (2.0, 4.0);
			polygon3.AddVertex (2.0, 2.0);
			polygon3.AddVertex (5.0, 2.0);
			polygon3.AddVertex (5.0, 6.0);
			polygon3.AddVertex (0.0, 6.0);

			var triangles = JSM.PolygonTriangulate2D (polygon3);
			test.Assert (JSM.CheckTriangulation2D (polygon3, triangles));
			test.Assert (triangles.length == 12);
			test.Assert (triangles[0].toString () == [2, 0, 1].toString ());
			test.Assert (triangles[1].toString () == [3, 0, 2].toString ());
			test.Assert (triangles[2].toString () == [4, 0, 3].toString ());
			test.Assert (triangles[3].toString () == [5, 12, 4].toString ());
			test.Assert (triangles[4].toString () == [13, 4, 12].toString ());
			test.Assert (triangles[5].toString () == [4, 13, 0].toString ());
			test.Assert (triangles[6].toString () == [6, 12, 5].toString ());
			test.Assert (triangles[7].toString () == [7, 10, 6].toString ());
			test.Assert (triangles[8].toString () == [11, 6, 10].toString ());
			test.Assert (triangles[9].toString () == [6, 11, 12].toString ());
			test.Assert (triangles[10].toString () == [8, 10, 7].toString ());
			test.Assert (triangles[11].toString () == [10, 8, 9].toString ());

			var polygon4 = new JSM.Polygon2D ();
			polygon4.AddVertex (52, 221);
			polygon4.AddVertex (101, 89);
			polygon4.AddVertex (244, 89);
			polygon4.AddVertex (188, 222);
			polygon4.AddVertex (104, 219);
			polygon4.AddVertex (135, 139);
			polygon4.AddVertex (167, 140);
			polygon4.AddVertex (152, 189);
			polygon4.AddVertex (170, 189);
			polygon4.AddVertex (192, 118);
			polygon4.AddVertex (118, 121);
			polygon4.AddVertex (77, 223);
			
			var triangles = JSM.PolygonTriangulate2D (polygon4);
			test.Assert (JSM.CheckTriangulation2D (polygon4, triangles));
			test.Assert (triangles.length == 10);
		}
		
		function PolygonTriangulationTest (test)
		{
			var polygon = new JSM.Polygon ();
			polygon.AddVertex (0.0, 0.0, 0.0);
			polygon.AddVertex (3.0, 0.0, 0.0);
			polygon.AddVertex (3.0, 2.0, 0.0);
			polygon.AddVertex (1.5, 3.0, 0.0);
			polygon.AddVertex (0.0, 2.0, 0.0);
			
			var triangles = JSM.PolygonTriangulate (polygon);
			test.Assert (triangles.length == 3);
			test.Assert (triangles[0].toString () == [0, 1, 2].toString ());
			test.Assert (triangles[1].toString () == [0, 2, 3].toString ());
			test.Assert (triangles[2].toString () == [0, 3, 4].toString ());
		}

		function PlaneTest (test)
		{
			var plane = new JSM.Plane (1.0, 2.0, 3.0, 4.0);
			test.Assert (plane.a == 1.0 && plane.b == 2.0 && plane.c == 3.0 && plane.d == 4.0);
			plane.Set (5.0, 6.0, 7.0, 8.0);
			test.Assert (plane.a == 5.0 && plane.b == 6.0 && plane.c == 7.0 && plane.d == 8.0);
			plane.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (0.0, 0.0, 1.0));
			test.Assert (plane.a == 0.0 && plane.b == 0.0 && plane.c == 1.0 && plane.d == 0.0);

			var plane1 = new JSM.Plane ();
			var plane2 = new JSM.Plane ();
			var plane3 = new JSM.Plane ();

			var coord1 = new JSM.Coord (0.0, 0.0, 0.0);
			var coord1b = new JSM.Coord (0.0, 0.0, 2.0);
			var coord2 = new JSM.Coord (1.0, 0.0, 0.0);
			var coord3 = new JSM.Coord (1.0, 1.0, 1.0);

			plane1.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (0.0, 0.0, 1.0));
			plane2.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (1.0, 0.0, 0.0));
			plane3.SetFromCoordAndDirection (new JSM.Coord (1.0, 1.0, 1.0), new JSM.Vector (0.0, 0.0, 1.0));
			
			test.Assert (JSM.CoordPlanePosition (coord1, plane1) == 'CoordOnPlane');
			test.Assert (JSM.CoordPlanePosition (coord1, plane2) == 'CoordOnPlane');
			test.Assert (JSM.CoordPlanePosition (coord1b, plane3) == 'CoordInFrontOfPlane');
			test.Assert (JSM.CoordPlanePosition (coord1, plane3) == 'CoordAtBackOfPlane');

			test.Assert (JSM.IsEqual (JSM.CoordPlaneSignedDirectionalDistance (coord1, new JSM.Coord (1.0, 0.0, 0.0), plane1), 0.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneSignedDirectionalDistance (coord1, new JSM.Coord (1.0, 0.0, 0.0), plane2), 0.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneSignedDirectionalDistance (coord1, new JSM.Coord (0.0, 0.0, 1.0), plane3), -1.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneSignedDirectionalDistance (coord1, new JSM.Coord (0.0, 1.0, 1.0), plane3), -1.4142135623));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneSignedDirectionalDistance (coord1b, new JSM.Coord (0.0, 1.0, 1.0), plane3), 1.4142135623));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDirectionalDistance (coord1, new JSM.Coord (0.0, 1.0, 1.0), plane3), 1.4142135623));
			
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord1, plane1), 0.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord1, plane2), 0.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord1, plane3), 1.0));

			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord2, plane1), 0.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord2, plane2), 1.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord2, plane3), 1.0));

			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord3, plane1), 1.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord3, plane2), 1.0));
			test.Assert (JSM.IsEqual (JSM.CoordPlaneDistance (coord3, plane3), 0.0));
			
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord1, plane1), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord1, plane2), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord1, plane3), new JSM.Coord (0.0, 0.0, 1.0)));

			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord2, plane1), new JSM.Coord (1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord2, plane2), new JSM.Coord (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord2, plane3), new JSM.Coord (1.0, 0.0, 1.0)));

			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord3, plane1), new JSM.Coord (1.0, 1.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord3, plane2), new JSM.Coord (0.0, 1.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (JSM.ProjectCoordToPlane (coord3, plane3), new JSM.Coord (1.0, 1.0, 1.0)));
			
			var line1 = new JSM.Line (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (1.0, 0.0, 0.0));
			var line2 = new JSM.Line (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (0.0, 0.0, 1.0));
			var line3 = new JSM.Line (new JSM.Coord (1.0, 2.0, 3.0), new JSM.Vector (0.0, 0.0, 1.0));
			test.Assert (JSM.LinePlanePosition (line1, plane1) == 'LineParallelToPlane');
			test.Assert (JSM.LinePlanePosition (line2, plane1) == 'LineIntersectsPlane');
			
			var intersection = new JSM.Coord ();
			test.Assert (JSM.LinePlanePosition (line3, plane1, intersection) == 'LineIntersectsPlane');
			test.Assert (JSM.CoordIsEqual (intersection, new JSM.Coord (1.0, 2.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (JSM.LinePlaneIntersection (line3, plane1), new JSM.Coord (1.0, 2.0, 0.0)));
		}

		function BodyTest (test)
		{
			var body = new JSM.Body ();
			test.Assert (body.VertexCount () == 0 && body.PolygonCount () == 0);
			
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 1, 0)));
			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 2]));
			test.Assert (body.VertexCount () == 3 && body.PolygonCount () == 1);
			test.Assert (JSM.CoordIsEqual (body.GetVertex (0).position, new JSM.Coord (0, 0, 0)));
			test.Assert (JSM.CoordIsEqual (body.GetVertex (1).position, new JSM.Coord (1, 0, 0)));
			test.Assert (JSM.CoordIsEqual (body.GetVertex (2).position, new JSM.Coord (0, 1, 0)));
			test.Assert (body.GetPolygon (0).vertices.toString () == [0, 1, 2].toString ());
			
			polygonNormals = JSM.CalculateBodyPolygonNormals (body);
			test.Assert (polygonNormals.length == 1);
			test.Assert (JSM.CoordIsEqual (polygonNormals[0], new JSM.Vector (0, 0, 1)));

			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 0, 1)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 1, 1)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 1, 1)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 0, 1)));
			body.AddPolygon (new JSM.BodyPolygon ([3, 4, 5, 6]));
			
			polygonNormals = JSM.CalculateBodyPolygonNormals (body);
			test.Assert (body.VertexCount () == 7 && body.PolygonCount () == 2);
			test.Assert (body.GetPolygon (0).VertexIndexCount () == 3);
			test.Assert (body.GetPolygon (1).VertexIndexCount () == 4);
			test.Assert (polygonNormals.length == 2);
			test.Assert (JSM.CoordIsEqual (polygonNormals[0], new JSM.Vector (0, 0, 1)));
			test.Assert (JSM.CoordIsEqual (polygonNormals[1], new JSM.Vector (0, 0, -1)));

			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 6]));
			polygonNormals = JSM.CalculateBodyPolygonNormals (body);
			test.Assert (polygonNormals.length == 3);
			test.Assert (JSM.CoordIsEqual (polygonNormals[2], new JSM.Vector (0, -1, 0)));
			
			test.Assert (JSM.CoordIsEqual (body.GetCenter (), new JSM.Coord (0.5, 0.5, 0.5)));
			
			body.Clear ();
			test.Assert (body.VertexCount () == 0 && body.PolygonCount () == 0);
		}

		function ModelTest (test)
		{
			var model = new JSM.Model ();
			model.AddBody (JSM.GenerateCuboid (1.0, 1.0, 1.0));
			model.AddBody (JSM.GenerateCuboid (1.0, 1.0, 1.0));
			test.Assert (model.BodyCount () == 2);
			test.Assert (model.GetBody (0).VertexCount () == 8);
			test.Assert (model.GetBody (1).VertexCount () == 8);
		}

		function BodyVertexToPolygonTest (test)
		{
			var body = new JSM.Body ();
			test.Assert (body.VertexCount () == 0 && body.PolygonCount () == 0);

			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 1, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 1, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (2, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (2, 1, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (2, 2, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 2, 0)));
			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 2, 3]));
			body.AddPolygon (new JSM.BodyPolygon ([1, 4, 5, 2]));
			body.AddPolygon (new JSM.BodyPolygon ([2, 5, 6, 7, 3]));
			test.Assert (body.VertexCount () == 8 && body.PolygonCount () == 3);
			
			var vertexToPolygon = JSM.CalculateBodyVertexToPolygon (body);
			test.Assert (vertexToPolygon[0].toString () == [0].toString ());
			test.Assert (vertexToPolygon[1].toString () == [0, 1].toString ());
			test.Assert (vertexToPolygon[2].toString () == [0, 1, 2].toString ());
			test.Assert (vertexToPolygon[3].toString () == [0, 2].toString ());
			test.Assert (vertexToPolygon[4].toString () == [1].toString ());
			test.Assert (vertexToPolygon[5].toString () == [1, 2].toString ());
			test.Assert (vertexToPolygon[6].toString () == [2].toString ());
			test.Assert (vertexToPolygon[7].toString () == [2].toString ());

			body.Clear ();
			test.Assert (body.VertexCount () == 0 && body.PolygonCount () == 0);
		}

		function BodyVertexNormalTest (test)
		{
			var body = new JSM.Body ();
			test.Assert (body.VertexCount () == 0 && body.PolygonCount () == 0);

			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 0, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 1, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0, 1, 0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 0, 1)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1, 1, 1)));
			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 2, 3]));
			body.AddPolygon (new JSM.BodyPolygon ([1, 2, 5, 4]));
			test.Assert (body.VertexCount () == 6 && body.PolygonCount () == 2);
			
			polygonNormals = JSM.CalculateBodyPolygonNormals (body);
			test.Assert (polygonNormals.length == 2);
			test.Assert (JSM.CoordIsEqual (polygonNormals[0], new JSM.Vector (0, 0, 1)));
			test.Assert (JSM.CoordIsEqual (polygonNormals[1], new JSM.Vector (1, 0, 0)));
			
			body.GetPolygon (0).SetCurveGroup (0);
			body.GetPolygon (1).SetCurveGroup (0);
			
			var vertexNormals = JSM.CalculateBodyVertexNormals (body);
			test.Assert (vertexNormals.length == 2);

			test.Assert (JSM.CoordIsEqual (vertexNormals[0][0], new JSM.Vector (0, 0, 1)));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][1], JSM.VectorNormalize (new JSM.Vector (1, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][2], JSM.VectorNormalize (new JSM.Vector (1, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][3], new JSM.Vector (0, 0, 1)));

			test.Assert (JSM.CoordIsEqual (vertexNormals[1][0], JSM.VectorNormalize (new JSM.Vector (1, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][1], JSM.VectorNormalize (new JSM.Vector (1, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][2], new JSM.Vector (1, 0, 0)));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][3], new JSM.Vector (1, 0, 0)));
		}
		
		function BodyPlanarTextureCoordTest (test)
		{
			var body = new JSM.Body ();
			
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 0.0, 0.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1.0, 0.0, 0.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1.0, 0.0, 1.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 0.0, 1.0)));
			
			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 2, 3]));

			body.SetTextureProjectionType ('Planar');
			body.SetTextureProjectionCoords (new JSM.CoordSystem (
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (0.0, 0.0, 1.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			));
			
			var textureCoords = JSM.CalculateBodyTextureCoords (body);
			test.Assert (textureCoords.length == 1);
			test.Assert (textureCoords[0].length == 4);
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][1], new JSM.Coord2D (1, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][2], new JSM.Coord2D (1, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][3], new JSM.Coord2D (0, 1)));

			body.SetTextureProjectionCoords (new JSM.CoordSystem (
				new JSM.Coord (0.2, 0.0, 0.2),
				new JSM.Coord (0.0, 0.0, 1.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			));
			
			var textureCoords = JSM.CalculateBodyTextureCoords (body);
			test.Assert (textureCoords.length == 1);
			test.Assert (textureCoords[0].length == 4);
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (-0.2, -0.2)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][1], new JSM.Coord2D (0.8, -0.2)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][2], new JSM.Coord2D (0.8, 0.8)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][3], new JSM.Coord2D (-0.2, 0.8)));

			body.SetTextureProjectionCoords (new JSM.CoordSystem (
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (0.0, 0.0, 1.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			));

			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 1.0, 0.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 1.0, 1.0)));
			
			body.AddPolygon (new JSM.BodyPolygon ([0, 3, 5, 4]));

			var textureCoords = JSM.CalculateBodyTextureCoords (body);
			test.Assert (textureCoords.length == 2);
			test.Assert (textureCoords[0].length == 4);
			test.Assert (textureCoords[1].length == 4);
			
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][1], new JSM.Coord2D (1, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][2], new JSM.Coord2D (1, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][3], new JSM.Coord2D (0, 1)));
			
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][1], new JSM.Coord2D (0, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][2], new JSM.Coord2D (0, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][3], new JSM.Coord2D (0, 0)));
		}
		
		function BodyCubicTextureCoordTest (test)
		{
			var body = new JSM.Body ();
			
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 0.0, 0.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1.0, 0.0, 0.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1.0, 0.0, 1.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 0.0, 1.0)));
			
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 1.0, 1.0)));
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (0.0, 1.0, 0.0)));
			
			body.AddVertex (new JSM.BodyVertex (new JSM.Coord (1.0, 1.0, 1.0)));
			
			body.AddPolygon (new JSM.BodyPolygon ([0, 1, 2, 3]));
			body.AddPolygon (new JSM.BodyPolygon ([0, 3, 4, 5]));
			body.AddPolygon (new JSM.BodyPolygon ([3, 2, 6, 4]));
			
			body.SetTextureProjectionType ('Cubic');
			body.SetTextureProjectionCoords (new JSM.CoordSystem (
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0),
				new JSM.Coord (0.0, 0.0, 1.0)
			));

			var textureCoords = JSM.CalculateBodyTextureCoords (body);
			test.Assert (textureCoords.length == 3);
			test.Assert (textureCoords[0].length == 4);
			test.Assert (textureCoords[1].length == 4);
			test.Assert (textureCoords[2].length == 4);
			
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][1], new JSM.Coord2D (1, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][2], new JSM.Coord2D (1, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][3], new JSM.Coord2D (0, 1)));
			
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][1], new JSM.Coord2D (0, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][2], new JSM.Coord2D (1, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][3], new JSM.Coord2D (1, 0)));

			test.Assert (JSM.CoordIsEqual2D (textureCoords[2][0], new JSM.Coord2D (0, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[2][1], new JSM.Coord2D (1, 0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[2][2], new JSM.Coord2D (1, 1)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[2][3], new JSM.Coord2D (0, 1)));
		}

		function BodyCylindricalTextureCoordTest (test)
		{
			var body = new JSM.GenerateCylinder (1.0, 1.0, 6.0, true, false);
			test.Assert (body.VertexCount () == 12);
			test.Assert (body.PolygonCount () == 8);
			
			var textureCoords = JSM.CalculateBodyTextureCoords (body);
			test.Assert (textureCoords.length == 8);
			test.Assert (textureCoords[0].length == 4);
			test.Assert (textureCoords[1].length == 4);
			test.Assert (textureCoords[2].length == 4);
			test.Assert (textureCoords[3].length == 4);
			test.Assert (textureCoords[4].length == 4);
			test.Assert (textureCoords[5].length == 4);
			
			var radius = 2.0 * Math.PI;
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (radius, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][1], new JSM.Coord2D (radius * 5.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][2], new JSM.Coord2D (radius * 5.0 / 6.0, 0.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][3], new JSM.Coord2D (radius, 0.0)));

			test.Assert (JSM.CoordIsEqual2D (textureCoords[0][0], new JSM.Coord2D (radius * 6.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[1][0], new JSM.Coord2D (radius * 5.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[2][0], new JSM.Coord2D (radius * 4.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[3][0], new JSM.Coord2D (radius * 3.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[4][0], new JSM.Coord2D (radius * 2.0 / 6.0, 1.0)));
			test.Assert (JSM.CoordIsEqual2D (textureCoords[5][0], new JSM.Coord2D (radius * 1.0 / 6.0, 1.0)));
		}
		
		function GenerateCuboidTest (test)
		{
			var cuboid = JSM.GenerateCuboid (1, 2, 3);
			test.Assert (cuboid.VertexCount () == 8 && cuboid.PolygonCount () == 6);
			
			var vertexNormals = JSM.CalculateBodyVertexNormals (cuboid);
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][0], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][1], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][2], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][3], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));

			test.Assert (JSM.CoordIsEqual (vertexNormals[5][0], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][1], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][2], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][3], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
		}
		
		function GenerateSphereTest (test)
		{
			function VertexCountFromSegmentation (segmentation)
			{
				return (2 * segmentation) * (segmentation - 1) + 2;
			}
		
			function PolygonCountFromSegmentation (segmentation)
			{
				return (2 * segmentation) * segmentation;
			}

			var sphere = JSM.GenerateSphere (1.0, 3, true);
			test.Assert (sphere.VertexCount () == 14 && sphere.PolygonCount () == 18);
			
			var sphere2 = JSM.GenerateSphere (1.0, 10, true);
			test.Assert (sphere2.VertexCount () == 182 && sphere2.PolygonCount () == 200);
		}

		function GenerateCylinderTest (test)
		{
			var cylinder = JSM.GenerateCylinder (1.0, 2.0, 25, true, true);
			test.Assert (cylinder.VertexCount () == 50 && cylinder.PolygonCount () == 27);
			test.Assert (cylinder.GetPolygon (0).VertexIndexCount () == 4);
			test.Assert (cylinder.GetPolygon (25).VertexIndexCount () == 25);
			test.Assert (cylinder.GetPolygon (26).VertexIndexCount () == 25);

			var cylinder2 = JSM.GenerateCylinder (1.0, 2.0, 4, true, true);
			test.Assert (cylinder2.VertexCount () == 8 && cylinder2.PolygonCount () == 6);
			test.Assert (cylinder2.GetPolygon (0).VertexIndexCount () == 4);
			test.Assert (cylinder2.GetPolygon (4).VertexIndexCount () == 4);
			test.Assert (cylinder2.GetPolygon (5).VertexIndexCount () == 4);
			
			var vertexNormals = JSM.CalculateBodyVertexNormals (cylinder2);
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][0], JSM.VectorNormalize (new JSM.Vector (1, 0, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][1], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][2], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][3], JSM.VectorNormalize (new JSM.Vector (1, 0, 0))));

			test.Assert (JSM.CoordIsEqual (vertexNormals[1][0], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][1], JSM.VectorNormalize (new JSM.Vector (-1, 0, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][2], JSM.VectorNormalize (new JSM.Vector (-1, 0, 0))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[1][3], JSM.VectorNormalize (new JSM.Vector (0, -1, 0))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][0], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][1], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][2], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][3], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][0], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][1], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][2], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][3], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			
			var cylinder3 = JSM.GenerateCylinder (1.0, 2.0, 25, false, true);
			test.Assert (cylinder3.VertexCount () == 50 && cylinder3.PolygonCount () == 25);
		}

		function GenerateConeTest (test)
		{
			var cone = JSM.GenerateCone (0.5, 1.0, 1.0, 25, true, true);
			test.Assert (cone.VertexCount () == 50 && cone.PolygonCount () == 27);
			test.Assert (cone.GetPolygon (0).VertexIndexCount () == 4);
			test.Assert (cone.GetPolygon (25).VertexIndexCount () == 25);
			test.Assert (cone.GetPolygon (26).VertexIndexCount () == 25);

			var cone2 = JSM.GenerateCone (0.5, 1.0, 1.0, 4, true, true);
			test.Assert (cone2.VertexCount () == 8 && cone2.PolygonCount () == 6);
			test.Assert (cone2.GetPolygon (0).VertexIndexCount () == 4);
			test.Assert (cone2.GetPolygon (4).VertexIndexCount () == 4);
			test.Assert (cone2.GetPolygon (5).VertexIndexCount () == 4);
			
			var vertexNormals = JSM.CalculateBodyVertexNormals (cone2);
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][0], JSM.VectorNormalize (new JSM.Vector (0.8944271909999159, 0, 0.4472135954999579))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][1], JSM.VectorNormalize (new JSM.Vector (0, -0.8944271909999159, 0.4472135954999579))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][2], JSM.VectorNormalize (new JSM.Vector (0, -0.8944271909999159, 0.4472135954999579))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[0][3], JSM.VectorNormalize (new JSM.Vector (0.8944271909999159, 0, 0.4472135954999579))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][0], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][1], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][2], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[4][3], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][0], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][1], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][2], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][3], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
		}
		
		function GeneratePrismTest (test)
		{
			var basePoints = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.5, 2.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			
			var direction = new JSM.Vector (0.0, 0.0, 1.0);
			var prism = JSM.GeneratePrism (basePoints, direction, 1.0, true);
			test.Assert (prism.VertexCount () == 10 && prism.PolygonCount () == 7);
			test.Assert (JSM.CoordIsEqual (prism.GetVertex (0).position, new JSM.Vector (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (prism.GetVertex (1).position, new JSM.Vector (0.0, 0.0, 1.0)));

			var vertexNormals = JSM.CalculateBodyVertexNormals (prism);
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][0], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][1], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][2], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][3], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][4], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][0], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][1], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][2], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][3], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][4], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));

			var basePoints2 = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.5, 0.5, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			
			var direction2 = new JSM.Vector (0.0, 0.0, 1.0);
			var prism2 = JSM.GeneratePrism (basePoints2, direction2, 1.0, true);

			var vertexNormals = JSM.CalculateBodyVertexNormals (prism2);
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][0], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][1], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][2], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][3], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[5][4], JSM.VectorNormalize (new JSM.Vector (0, 0, 1))));
			
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][0], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][1], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][2], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][3], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
			test.Assert (JSM.CoordIsEqual (vertexNormals[6][4], JSM.VectorNormalize (new JSM.Vector (0, 0, -1))));
		}
		
		function GeneratePrismShellTest (test)
		{
			var basePoints = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.5, 2.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			
			var direction = new JSM.Vector (0.0, 0.0, 1.0);
			var prism = JSM.GeneratePrismShell (basePoints, direction, 1.0, 0.1, true);
			test.Assert (prism.VertexCount () == 20 && prism.PolygonCount () == 20);
			test.Assert (JSM.CoordIsEqual (prism.GetVertex (0).position, new JSM.Vector (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (prism.GetVertex (10).position, new JSM.Vector (0.0, 0.0, 1.0)));
		}

		function GenerateLineShellTest (test)
		{
			var basePoints = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.5, 2.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];
			
			var direction = new JSM.Vector (0.0, 0.0, 1.0);
			var shell = JSM.GenerateLineShell (basePoints, direction, 1.0, 0.1, true, true);
			test.Assert (shell.VertexCount () == 20 && shell.PolygonCount () == 18);
			test.Assert (JSM.CoordIsEqual (shell.GetVertex (0).position, new JSM.Vector (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (shell.GetVertex (10).position, new JSM.Vector (0.0, 0.0, 1.0)));
		}

		function GenerateTorusTest (test)
		{
			//JSM.GenerateTorus = function (outerRadius, innerRadius, outerSegmentation, innerSegmentation, isCurved)
			var prism = JSM.GenerateTorus (1.0, 5.0, 10, 10, true);
			test.Assert (prism.VertexCount () == 100 && prism.PolygonCount () == 100);
		}
		
		function GenerateRuledTest (test)
		{
			var aCoords = [new JSM.Coord (0.0, 0.0, 0.0), new JSM.Coord (1.0, 0.0, 0.0), new JSM.Coord (2.0, 0.0, 0.0)];
			var bCoords = [new JSM.Coord (0.0, 2.0, 0.0), new JSM.Coord (1.0, 2.0, 0.0), new JSM.Coord (2.0, 2.0, 0.0)];
			var vertices = [];
			var polygons = [];
			
			JSM.GetRuledMesh (aCoords, bCoords, 2, vertices, polygons);
			test.Assert (vertices.length == 9);
			test.Assert (polygons.length == 4);
			test.Assert (JSM.CoordIsEqual (vertices[4], new JSM.Vector (1.0, 1.0, 0.0)));

			var ruledFromCoords = JSM.GenerateRuledFromCoords (aCoords, bCoords, 2);
			test.Assert (ruledFromCoords.VertexCount () == 9);
			test.Assert (ruledFromCoords.PolygonCount () == 4);
			test.Assert (JSM.CoordIsEqual (ruledFromCoords.GetVertex (4).position, new JSM.Vector (1.0, 1.0, 0.0)));
			
			var sector1 = new JSM.Sector (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Coord (2.0, 0.0, 0.0));
			var sector2 = new JSM.Sector (new JSM.Coord (0.0, 2.0, 0.0), new JSM.Coord (2.0, 2.0, 0.0));
			var sector1Coords = [];
			JSM.GetLineSegmentation (sector1.beg, sector1.end, 2, sector1Coords);
			test.Assert (sector1Coords.length == 3);
			test.Assert (JSM.CoordIsEqual (sector1Coords[0], new JSM.Vector (0.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (sector1Coords[1], new JSM.Vector (1.0, 0.0, 0.0)));
			test.Assert (JSM.CoordIsEqual (sector1Coords[2], new JSM.Vector (2.0, 0.0, 0.0)));
			
			var ruledFromSectors = JSM.GenerateRuledFromSectors (sector1, sector2, 2, 2, false);
			test.Assert (ruledFromSectors.VertexCount () == 9);
			test.Assert (ruledFromSectors.PolygonCount () == 4);
			test.Assert (JSM.CoordIsEqual (ruledFromSectors.GetVertex (4).position, new JSM.Vector (1.0, 1.0, 0.0)));

			var ruledFromSectors2 = JSM.GenerateRuledFromSectors (sector1, sector2, 10, 10, false);
			test.Assert (ruledFromSectors2.VertexCount () == 121);
			test.Assert (ruledFromSectors2.PolygonCount () == 100);
			test.Assert (JSM.CoordIsEqual (ruledFromSectors2.GetVertex (60).position, new JSM.Vector (1.0, 1.0, 0.0)));
		}
		
		function GenerateRevolvedTest (test)
		{
			var polyLine = [
				new JSM.Coord (0.5, 0.0, 0.0),
				new JSM.Coord (0.5, 0.0, 0.5)
			];
			var axis = new JSM.Sector (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Coord (0.0, 0.0, 1.0));
			var revolved = JSM.GenerateRevolved (polyLine, axis, 360.0 * JSM.DegRad, 10, true, false);
			test.Assert (revolved.VertexCount () == 20);
			test.Assert (revolved.PolygonCount () == 12);

			var vertexNormals = JSM.CalculateBodyVertexNormals (revolved);
			test.Assert (JSM.CoordIsEqual (vertexNormals[10][0], new JSM.Vector (0.0, 0.0, 1.0)));
			test.Assert (JSM.CoordIsEqual (vertexNormals[11][0], new JSM.Vector (0.0, 0.0, -1.0)));
			
			var openRevolved = JSM.GenerateRevolved (polyLine, axis, 180.0 * JSM.DegRad, 10, true, false);
			test.Assert (openRevolved.VertexCount () == 22);
			test.Assert (openRevolved.PolygonCount () == 10);
		}
		
		function GenerateFunctionSurfaceTest (test)
		{
			function TheFunction (x, y)
			{
				return x * x + y * y;
			}

			var intervalMin = new JSM.Coord2D (-1.0, -1.0);
			var intervalMax = new JSM.Coord2D (1.0, 1.0);
			var surface = JSM.GenerateFunctionSurface (TheFunction, intervalMin, intervalMax, 2, true);
			test.Assert (surface.VertexCount () == 9 && surface.PolygonCount () == 4);
			for (var i = 0; i < surface.VertexCount (); i++) {
				var coord = surface.GetVertex (i).position;
				test.Assert (JSM.IsEqual (coord.z, TheFunction (coord.x, coord.y)));
			}
		}

		function SolidGeneratorTest (test)
		{
			var ArePolygonsRegular = function (body)
			{
				var i, j, polygon, first, last, length, a, b, currentLength;
				for (i = 0; i < body.PolygonCount (); i++) {
					polygon = body.GetPolygon (i);
					first = body.GetVertex (polygon.GetVertexIndex (0));
					last = body.GetVertex (polygon.GetVertexIndex (polygon.VertexIndexCount () - 1));
					length = JSM.CoordDistance (first.position, last.position);
					for (j = 1; j < polygon.VertexIndexCount (); j++) {
						a = body.GetVertex (polygon.GetVertexIndex (j - 1));
						b = body.GetVertex (polygon.GetVertexIndex (j));
						currentLength = JSM.CoordDistance (a.position, b.position);
						if (!JSM.IsEqual (length, currentLength)) {
							return false;
						}
					}
				}
				return true;
			};
		
			var solid = null;

			solid = JSM.GenerateSolidWithRadius ('Tetrahedron', 1.0);
			test.Assert (solid.VertexCount () == 4 && solid.PolygonCount () == 4);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Hexahedron', 1.0);
			test.Assert (solid.VertexCount () == 8 && solid.PolygonCount () == 6);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Octahedron', 1.0);
			test.Assert (solid.VertexCount () == 6 && solid.PolygonCount () == 8);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Dodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 20 && solid.PolygonCount () == 12);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Icosahedron', 1.0);
			test.Assert (solid.VertexCount () == 12 && solid.PolygonCount () == 20);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedTetrahedron', 1.0);
			test.Assert (solid.VertexCount () == 12 && solid.PolygonCount () == 8);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Cuboctahedron', 1.0);
			test.Assert (solid.VertexCount () == 12 && solid.PolygonCount () == 14);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedCube', 1.0);
			test.Assert (solid.VertexCount () == 24 && solid.PolygonCount () == 14);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedOctahedron', 1.0);
			test.Assert (solid.VertexCount () == 24 && solid.PolygonCount () == 14);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Rhombicuboctahedron', 1.0);
			test.Assert (solid.VertexCount () == 24 && solid.PolygonCount () == 26);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedCuboctahedron', 1.0);
			test.Assert (solid.VertexCount () == 48 && solid.PolygonCount () == 26);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('SnubCube', 1.0);
			test.Assert (solid.VertexCount () == 24 && solid.PolygonCount () == 38);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Icosidodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 30 && solid.PolygonCount () == 32);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedDodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 60 && solid.PolygonCount () == 32);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedIcosahedron', 1.0);
			test.Assert (solid.VertexCount () == 60 && solid.PolygonCount () == 32);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('Rhombicosidodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 60 && solid.PolygonCount () == 62);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('TruncatedIcosidodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 120 && solid.PolygonCount () == 62);
			test.Assert (ArePolygonsRegular (solid));

			solid = JSM.GenerateSolidWithRadius ('SnubDodecahedron', 1.0);
			test.Assert (solid.VertexCount () == 60 && solid.PolygonCount () == 92);
			test.Assert (ArePolygonsRegular (solid));
		}

		function CutTest (test)
		{
			var polygon = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (1.0, 0.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (0.0, 1.0, 0.0)
			];

			var plane = new JSM.Plane ();
			plane.SetFromCoordAndDirection (new JSM.Coord (2.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			var indexTable = [];
			var cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);

			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (1.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == 1 &&
				indexTable[2] == 2 &&
				indexTable[3] == 3
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (-1.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 0);
			test.Assert (indexTable.length == 0);

			plane.SetFromCoordAndDirection (new JSM.Coord (0.5, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (0.5, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (0.5, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == -1 &&
				indexTable[2] == -1 &&
				indexTable[3] == 3
				);		

			plane.SetFromCoordAndDirection (new JSM.Coord (0.5, 0.0, 0.0), new JSM.Vector (1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.5, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (1.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.5, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == -1 &&
				indexTable[1] == 1 &&
				indexTable[2] == 2 &&
				indexTable[3] == -1
				);		

			plane.SetFromCoordAndDirection (new JSM.Coord (0.8, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);	
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (0.8, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (0.8, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == -1 &&
				indexTable[2] == -1 &&
				indexTable[3] == 3
				);		

			plane.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 2);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 2);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == 3
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (-1.0, 1.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 3);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 3);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == 2 &&
				indexTable[2] == 3
				);

			polygon = [
				new JSM.Coord (-1.0, -1.0, 0.0),
				new JSM.Coord (-1.0, 1.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (1.0, -1.0, 0.0)
			];

			plane.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, -1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (-1.0, -1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (-1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.0, 1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == -1 &&
				indexTable[1] == 0 &&
				indexTable[2] == 1 &&
				indexTable[3] == -1
				);		

			plane.SetFromCoordAndDirection (new JSM.Coord (0.0, 0.0, 0.0), new JSM.Vector (1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, -1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (0.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (1.0, -1.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == -1 &&
				indexTable[1] == -1 &&
				indexTable[2] == 2 &&		
				indexTable[3] == 3
				);

			var polygon = [
				new JSM.Coord (0.0, 0.0, 0.0),
				new JSM.Coord (2.0, 0.0, 0.0),
				new JSM.Coord (2.0, 1.0, 0.0),
				new JSM.Coord (1.0, 1.0, 0.0),
				new JSM.Coord (1.0, 2.0, 0.0),
				new JSM.Coord (2.0, 2.0, 0.0),
				new JSM.Coord (2.0, 3.0, 0.0),
				new JSM.Coord (0.0, 3.0, 0.0)
			];

			plane.SetFromCoordAndDirection (new JSM.Coord (3.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 8);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (2.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (2.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[4], new JSM.Vector (1.0, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[5], new JSM.Vector (2.0, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[6], new JSM.Vector (2.0, 3.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[7], new JSM.Vector (0.0, 3.0, 0.0))
				);
			test.Assert (indexTable.length == 8);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == 1 &&
				indexTable[2] == 2 &&
				indexTable[3] == 3 &&
				indexTable[4] == 4 &&
				indexTable[5] == 5 &&
				indexTable[6] == 6 &&
				indexTable[7] == 7
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (1.5, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 8);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (1.5, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (1.5, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[4], new JSM.Vector (1.0, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[5], new JSM.Vector (1.5, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[6], new JSM.Vector (1.5, 3.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[7], new JSM.Vector (0.0, 3.0, 0.0))
				);
			test.Assert (indexTable.length == 8);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == -1 &&
				indexTable[2] == -1 &&
				indexTable[3] == 3 &&
				indexTable[4] == 4 &&
				indexTable[5] == -1 &&
				indexTable[6] == -1 &&
				indexTable[7] == 7
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (0.5, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 4);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (0.5, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (0.5, 3.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (0.0, 3.0, 0.0))
				);
			test.Assert (indexTable.length == 4);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == -1 &&
				indexTable[2] == -1 &&
				indexTable[3] == 7
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (1.0, 0.0, 0.0), new JSM.Vector (-1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 6);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (0.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (1.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (1.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (1.0, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[4], new JSM.Vector (1.0, 3.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[5], new JSM.Vector (0.0, 3.0, 0.0))
				);
			test.Assert (indexTable.length == 6);
			test.Assert (
				indexTable[0] == 0 &&
				indexTable[1] == -1 &&
				indexTable[2] == 3 &&
				indexTable[3] == 4 &&
				indexTable[4] == -1 &&
				indexTable[5] == 7
				);

			plane.SetFromCoordAndDirection (new JSM.Coord (1.5, 0.0, 0.0), new JSM.Vector (1.0, 0.0, 0.0));
			indexTable = [];
			cutted = JSM.CutPolygonByPlane (polygon, plane, indexTable);
			test.Assert (cutted.length == 8);
			test.Assert (
				JSM.CoordIsEqual (cutted[0], new JSM.Vector (1.5, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[1], new JSM.Vector (2.0, 0.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[2], new JSM.Vector (2.0, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[3], new JSM.Vector (1.5, 1.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[4], new JSM.Vector (1.5, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[5], new JSM.Vector (2.0, 2.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[6], new JSM.Vector (2.0, 3.0, 0.0)) &&
				JSM.CoordIsEqual (cutted[7], new JSM.Vector (1.5, 3.0, 0.0))
				);
			test.Assert (indexTable.length == 8);
			test.Assert (
				indexTable[0] == -1 &&
				indexTable[1] == 1 &&
				indexTable[2] == 2 &&
				indexTable[3] == -1 &&
				indexTable[4] == -1 &&
				indexTable[5] == 5 &&
				indexTable[6] == 6 &&
				indexTable[7] == -1
				);
		}

		function Load ()
		{
			var test = new JSM.Test ('result');
			test.AddTestCase (CoreTest, 'CoreTest');
			test.AddTestCase (VectorTest, 'VectorTest');
			test.AddTestCase (MatrixTest, 'MatrixTest');
			test.AddTestCase (ArcLengthTest, 'ArcLengthTest');
			test.AddTestCase (TransformationTest, 'TransformationTest');
			test.AddTestCase (SystemConversionTest, 'SystemConversionTest');
			test.AddTestCase (SectorTest, 'SectorTest');
			test.AddTestCase (LineTest, 'LineTest');
			test.AddTestCase (CoordSectorPosition2DTest, 'CoordSectorPosition2DTest');
			test.AddTestCase (SectorSectorPosition2DTest, 'SectorSectorPosition2DTest');
			test.AddTestCase (CoordPolygonPosition2DTest, 'CoordPolygonPosition2DTest');
			test.AddTestCase (PolygonTest, 'PolygonTest');
			test.AddTestCase (PolygonVertexVisibility2DTest, 'PolygonVertexVisibility2DTest');
			test.AddTestCase (PolygonTriangulation2DTest, 'PolygonTriangulation2DTest');
			test.AddTestCase (PolygonTriangulationTest, 'PolygonTriangulationTest');
			test.AddTestCase (PlaneTest, 'PlaneTest');
			test.AddTestCase (BodyTest, 'BodyTest');
			test.AddTestCase (ModelTest, 'ModelTest');
			test.AddTestCase (BodyVertexToPolygonTest, 'BodyVertexToPolygonTest');
			test.AddTestCase (BodyVertexNormalTest, 'BodyVertexNormalTest');
			test.AddTestCase (BodyPlanarTextureCoordTest, 'BodyPlanarTextureCoordTest');
			test.AddTestCase (BodyCubicTextureCoordTest, 'BodyCubicTextureCoordTest');
			test.AddTestCase (BodyCylindricalTextureCoordTest, 'BodyCylindricalTextureCoordTest');
			test.AddTestCase (GenerateCuboidTest, 'GenerateCuboidTest');
			test.AddTestCase (GenerateSphereTest, 'GenerateSphereTest');
			test.AddTestCase (GenerateCylinderTest, 'GenerateCylinderTest');
			test.AddTestCase (GenerateConeTest, 'GenerateConeTest');
			test.AddTestCase (GeneratePrismTest, 'GeneratePrismTest');
			test.AddTestCase (GeneratePrismShellTest, 'GeneratePrismShellTest');
			test.AddTestCase (GenerateLineShellTest, 'GenerateLineShellTest');
			test.AddTestCase (GenerateTorusTest, 'GenerateTorusTest');
			test.AddTestCase (GenerateRuledTest, 'GenerateRuledTest');
			test.AddTestCase (GenerateRevolvedTest, 'GenerateRevolvedTest');
			test.AddTestCase (GenerateFunctionSurfaceTest, 'GenerateFunctionSurfaceTest');
			test.AddTestCase (SolidGeneratorTest, 'SolidGeneratorTest');
			test.AddTestCase (CutTest, 'CutTest');
			test.Run ();
		}
	
	    window.onload = function ()
		{
			Load ();			
		}

	</script>

</head>

<body>
	<div id="result"></div>
</body>

</html>
