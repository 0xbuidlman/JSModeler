<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
	 "http://www.w3.org/TR/html4/strict.dtd">

<html>

<head>

	<meta http-equiv="content-type" content="text/html;charset=utf-8">
	<link rel="stylesheet" type="text/css" href="surfacepc.css">
<!-- JSModeler includes start -->
	<script type="text/javascript" src="../../src/core/jsm.js"></script>
	<script type="text/javascript" src="../../src/core/timer.js"></script>
	<script type="text/javascript" src="../../src/core/algorithm.js"></script>
	<script type="text/javascript" src="../../src/geometry/coord.js"></script>
	<script type="text/javascript" src="../../src/geometry/determinant.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/matrix.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordsystem.js"></script>
	<script type="text/javascript" src="../../src/geometry/coordsystemutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/sector.js"></script>
	<script type="text/javascript" src="../../src/geometry/sectorutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/line.js"></script>
	<script type="text/javascript" src="../../src/geometry/lineutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/transformation.js"></script>
	<script type="text/javascript" src="../../src/geometry/transformationutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/plane.js"></script>
	<script type="text/javascript" src="../../src/geometry/planeutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/projection.js"></script>
	<script type="text/javascript" src="../../src/geometry/convexhull.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygon.js"></script>
	<script type="text/javascript" src="../../src/geometry/polygonutils.js"></script>
	<script type="text/javascript" src="../../src/geometry/bsptree.js"></script>
	<script type="text/javascript" src="../../src/geometry/utilities.js"></script>
	<script type="text/javascript" src="../../src/modeler/body.js"></script>
	<script type="text/javascript" src="../../src/modeler/model.js"></script>
	<script type="text/javascript" src="../../src/modeler/color.js"></script>
	<script type="text/javascript" src="../../src/modeler/light.js"></script>
	<script type="text/javascript" src="../../src/modeler/material.js"></script>
	<script type="text/javascript" src="../../src/modeler/bodyutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/adjacencylist.js"></script>
	<script type="text/javascript" src="../../src/modeler/textureutils.js"></script>
	<script type="text/javascript" src="../../src/modeler/cututils.js"></script>
	<script type="text/javascript" src="../../src/modeler/generator.js"></script>
	<script type="text/javascript" src="../../src/modeler/camera.js"></script>
	<script type="text/javascript" src="../../src/modeler/explode.js"></script>
	<script type="text/javascript" src="../../src/modeler/exporter.js"></script>
	<script type="text/javascript" src="../../src/extras/solidgenerator.js"></script>
	<script type="text/javascript" src="../../src/extras/extgenerator.js"></script>
	<script type="text/javascript" src="../../src/extras/painter.js"></script>
	<script type="text/javascript" src="../../src/extras/drawing.js"></script>
	<script type="text/javascript" src="../../src/extras/subdivision.js"></script>
	<script type="text/javascript" src="../../src/extras/svgtomodel.js"></script>
	<script type="text/javascript" src="../../src/extras/csg.js"></script>
	<script type="text/javascript" src="../../src/extras/surfaces.js"></script>
	<script type="text/javascript" src="../../src/renderer/renderer.js"></script>
	<script type="text/javascript" src="../../src/renderer/pointcloudrenderer.js"></script>
	<script type="text/javascript" src="../../src/renderer/converter.js"></script>
	<script type="text/javascript" src="../../src/viewer/jsonfileloader.js"></script>
	<script type="text/javascript" src="../../src/viewer/mouse.js"></script>
	<script type="text/javascript" src="../../src/viewer/touch.js"></script>
	<script type="text/javascript" src="../../src/viewer/navigation.js"></script>
	<script type="text/javascript" src="../../src/viewer/softwareviewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/spriteviewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/viewer.js"></script>
	<script type="text/javascript" src="../../src/viewer/pointcloudviewer.js"></script>
	<script type="text/javascript" src="../../src/three/threeconverter.js"></script>
	<script type="text/javascript" src="../../src/three/threeviewer.js"></script>
<!-- JSModeler includes end -->

	<script type="text/javascript" src="pcgenerator.js"></script>
	<title>Example</title>

	<script type="text/javascript">
		var viewer = null;
		var pcGenerator = null;
		var fps = new JSM.FPSCounter ();
		var lastSurfaceIndex = 0;

		function ShowHideDiv (divName)
		{
			var div = document.getElementById (divName);
			if (div.style.display == 'none') {
				div.style.display = 'block';
			} else {
				div.style.display = 'none';
			}
		}
		
		function Render ()
		{
			viewer.Draw ();
			requestAnimationFrame (Render);
			document.getElementById ('fps').innerHTML = 'fps: ' + fps.Get (500);
		}

		function SetPointNum (pointCount)
		{
			pcGenerator.SetPointNum (pointCount);
			UpdatePointCloud (lastSurfaceIndex, false);
		}
		
		function SetColorScheme (colorScheme)
		{
			pcGenerator.SetColorScheme (colorScheme);
			UpdatePointCloud (lastSurfaceIndex, false);
		}

		function UpdatePointCloud (index, fitInWindow)
		{
			viewer.RemovePoints ();
			var pc = null;
			
			switch (index) {
				case 0: pc = pcGenerator.GenerateSeaShell (); break;
				case 1: pc = pcGenerator.GenerateMobiusStrip (); break;
				case 2: pc = pcGenerator.GenerateKleinBottle (); break;
				case 3: pc = pcGenerator.GenerateSteinerSurface (); break;
				case 4: pc = pcGenerator.GenerateDinisSurface (); break;
			}

			if (pc !== null) {
				viewer.AddPoints (pc[0], pc[1]);
				if (fitInWindow) {
					viewer.FitInWindow ();
				}
			}
			
			lastSurfaceIndex = index;
		}

		function Resize ()
		{
			var canvas = document.getElementById ('example');
			if (canvas !== null) {
				canvas.width = document.body.clientWidth;
				canvas.height = document.body.clientHeight;
			}
		}

		function Load ()
		{
			window.onresize = Resize;
			Resize ();

			pcGenerator = new PointCloudGenerator ();
			
			var camera = new JSM.Camera (
				new JSM.Coord (1.0, 3.0, 2.0),
				new JSM.Coord (0.5, 0.5, 0.5),
				new JSM.Vector (0.0, 0.0, 1.0),
				45.0,
				0.1,
				100000000
			);
					
			viewer = new JSM.PointCloudViewer ();
			if (!viewer.Init ('example', camera)) {
				alert ('error');
			}
			
			viewer.SetClearColor (0.0, 0.0, 0.0);
			Render ();

			UpdatePointCloud (lastSurfaceIndex, true);
		}
	
	    window.onload = function ()
		{
			Load ();
		}
	</script>

</head>

<body>
	<div id="menu">
		<div class="menutitle"><a href="javascript:ShowHideDiv ('surfacelist')">surfaces</a></div>
		<div id="surfacelist">
			<div class="menuitem"><a href="javascript:UpdatePointCloud (0, true)">seashell</a></div>
			<div class="menuitem"><a href="javascript:UpdatePointCloud (1, true)">mobius strip</a></div>
			<div class="menuitem"><a href="javascript:UpdatePointCloud (2, true)">klein bottle</a></div>
			<div class="menuitem"><a href="javascript:UpdatePointCloud (3, true)">steiner surface</a></div>
			<div class="menuitem"><a href="javascript:UpdatePointCloud (4, true)">dini's surface</a></div>
		</div>
		<div class="menutitle"><a href="javascript:ShowHideDiv ('settingslist')">settings</a></div>
		<div id="settingslist">
			<div class="menuitem">
				points: 
				<a href="javascript:SetPointNum (10000)">10K</a> |
				<a href="javascript:SetPointNum (100000)">100K</a> |
				<a href="javascript:SetPointNum (1000000)">1M</a>
			</div>
			<div class="menuitem">
				colors: 
				<a href="javascript:SetColorScheme (1)">RG</a> |
				<a href="javascript:SetColorScheme (2)">RB</a> |
				<a href="javascript:SetColorScheme (3)">GB</a>
			</div>
			<div id="fps" class="menuitem">0</div>
		</div>
	</div>
	<canvas id="example" width="800" height="500"></canvas>
</body>

</html>
